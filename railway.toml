[build]
builder = "NIXPACKS"
buildCommand = "uv sync"

[deploy]
startCommand = "uv run fastapi run src/main.py --port $PORT --workers 2"
healthcheckPath = "/health"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[env]
# Required environment variables (set in Railway dashboard):
# POCKETBASE_URL - Internal service URL (e.g., http://pocketbase.railway.internal:8090)
# OPENROUTER_API_KEY - API key for OpenRouter
# WHATSAPP_VERIFY_TOKEN - WhatsApp webhook verification token
# WHATSAPP_APP_SECRET - WhatsApp app secret for signature validation
# WHATSAPP_ACCESS_TOKEN - WhatsApp Cloud API access token
# WHATSAPP_PHONE_NUMBER_ID - WhatsApp business phone number ID
# LOGFIRE_TOKEN - Pydantic Logfire token
# HOUSE_CODE - House join code
# HOUSE_PASSWORD - House join password
# MODEL_ID - Optional, defaults to Claude 3.5 Sonnet
